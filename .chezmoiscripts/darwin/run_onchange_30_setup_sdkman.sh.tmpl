#!/bin/bash

# Put .sdkman to home directory so that initialization script could work without calling brew
export SDKMAN_DIR=$(brew --prefix sdkman-cli)/libexec

# Initialize sdkman if available
if [ -f "$SDKMAN_DIR/bin/sdkman-init.sh" ]; then
    source "$SDKMAN_DIR/bin/sdkman-init.sh"
    echo "âœ…  sdkman initialized"
else
    echo "âŒ  sdkman init script not found"
    exit 1
fi

# Verify sdkman installation
if ! command -v sdk >/dev/null 2>&1; then
    echo "âŒ  sdk command is not available after initialization"
    exit 1
fi

echo "ğŸ› ï¸  Configuring sdkman preferences & components"
source "$SDKMAN_DIR/bin/sdkman-init.sh"

# Install Java
echo "ğŸ› ï¸  Installing Java (Temurin)"
echo "n" | sdk install java 21-tem
echo "Y" | sdk install java 25-tem
sdk default java 25-tem

# Install Build Tools
echo "ğŸ› ï¸  Installing Build Tools"
echo "Y" | sdk install gradle
echo "Y" | sdk install maven

echo "âœ…  Done. sdkman and all the necessary SDKs are configured"
